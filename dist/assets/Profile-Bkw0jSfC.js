import{f as x,j as s,G as _,n as v,b9 as I,B as l,T as n,A as C,L as d,I as t,ba as c}from"./index-CPsAi7gg.js";import{A as L}from"./Alert-b5b2f2eR.js";import{C as p,a as u}from"./CardContent-C7uEvFoc.js";import{D as g}from"./Divider-QgutM9kn.js";import{L as a,P as f,A as P}from"./Person-D8jrqIFT.js";import{C as y}from"./Chip-fN361k0a.js";import"./IconButton-BH35efnM.js";import"./CircularProgress-CXFRefgw.js";const E=x(s.jsx("path",{d:"M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5s-3 1.34-3 3 1.34 3 3 3m-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5 5 6.34 5 8s1.34 3 3 3m0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5m8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5"})),T=x(s.jsx("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2m6.93 6h-2.95c-.32-1.25-.78-2.45-1.38-3.56 1.84.63 3.37 1.91 4.33 3.56M12 4.04c.83 1.2 1.48 2.53 1.91 3.96h-3.82c.43-1.43 1.08-2.76 1.91-3.96M4.26 14C4.1 13.36 4 12.69 4 12s.1-1.36.26-2h3.38c-.08.66-.14 1.32-.14 2s.06 1.34.14 2zm.82 2h2.95c.32 1.25.78 2.45 1.38 3.56-1.84-.63-3.37-1.9-4.33-3.56m2.95-8H5.08c.96-1.66 2.49-2.93 4.33-3.56C8.81 5.55 8.35 6.75 8.03 8M12 19.96c-.83-1.2-1.48-2.53-1.91-3.96h3.82c-.43 1.43-1.08 2.76-1.91 3.96M14.34 14H9.66c-.09-.66-.16-1.32-.16-2s.07-1.35.16-2h4.68c.09.65.16 1.32.16 2s-.07 1.34-.16 2m.25 5.56c.6-1.11 1.06-2.31 1.38-3.56h2.95c-.96 1.65-2.49 2.93-4.33 3.56M16.36 14c.08-.66.14-1.32.14-2s-.06-1.34-.14-2h3.38c.16.64.26 1.31.26 2s-.1 1.36-.26 2z"})),M=x(s.jsx("path",{d:"M12 17.27 18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"})),A=x(s.jsx("path",{d:"M9.78 18.65l.28-4.23 7.68-6.92c.34-.31-.07-.46-.52-.19L7.74 13.3 3.64 12c-.88-.25-.89-.86.2-1.3l15.97-6.16c.73-.33 1.43.18 1.15 1.3l-2.72 12.81c-.19.91-.74 1.13-1.5.71L12.6 16.3l-1.99 1.93c-.23.23-.42.42-.83.42z"})),R=()=>{var j;console.log("🚀 === PROFILE COMPONENT MOUNTED ===");const b=_(),{currentUser:o,isUserLoading:h,userError:m}=v(r=>r.aeonChat),{telegramUser:i}=I();console.log("🚀 === PROFILE COMPONENT DEBUG ==="),console.log("🔍 Profile component - currentUser:",o),console.log("🔍 Profile component - currentUser.subordinates:",o==null?void 0:o.subordinates),console.log("🔍 Profile component - currentUser.managers:",o==null?void 0:o.managers),console.log("🔍 Profile component - telegramUser:",i),console.log("🔍 Profile component - telegramUser?.photo_url:",i==null?void 0:i.photo_url),console.log("🔍 Profile component - isUserLoading:",h),console.log("🔍 Profile component - userError:",m),console.log("🚀 === END PROFILE DEBUG ===");const e=o?{...o,subordinates:Array.isArray(o.subordinates)?o.subordinates:[],managers:Array.isArray(o.managers)?o.managers:[]}:null;return h?s.jsx(l,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:s.jsx(n,{children:"Загрузка профиля..."})}):m?s.jsx(l,{sx:{height:"100vh",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",bgcolor:"rgba(35, 43, 59, 0.95)",p:3},children:s.jsxs(L,{severity:"error",sx:{mb:3,maxWidth:"600px"},children:[s.jsx(n,{variant:"h6",sx:{mb:2},children:"🚫 Ошибка авторизации"}),s.jsx(n,{variant:"body1",sx:{mb:2,fontWeight:"bold"},children:"Проблема с авторизацией на сервере"}),s.jsx(n,{variant:"body2",sx:{mb:2},children:"Сервер отклоняет авторизацию. Возможные причины:"}),s.jsxs(n,{variant:"body2",component:"ul",sx:{pl:2,mb:2},children:[s.jsx("li",{children:"На сервере не настроен токен Telegram бота"}),s.jsx("li",{children:"Неправильный или истёкший токен бота"}),s.jsx("li",{children:"Проблема с подписью данных авторизации"}),s.jsx("li",{children:"Приложение запущено не из Telegram"})]}),s.jsx(n,{variant:"body2",sx:{mb:2},children:s.jsx("strong",{children:"Что делать:"})}),s.jsxs(n,{variant:"body2",component:"ul",sx:{pl:2,mb:2},children:[s.jsx("li",{children:"Убедитесь, что приложение открыто из Telegram"}),s.jsx("li",{children:"Если вы администратор - проверьте настройки сервера"}),s.jsx("li",{children:"Если проблема повторяется - обратитесь в поддержку"})]})]})}):e?s.jsxs(l,{sx:{p:3,maxWidth:800,mx:"auto"},children:[s.jsx(n,{variant:"h4",gutterBottom:!0,sx:{mb:4,fontWeight:"bold"},children:"Профиль пользователя"}),s.jsxs(l,{sx:{display:"flex",flexDirection:{xs:"column",md:"row"},gap:3},children:[s.jsx(l,{sx:{flex:1},children:s.jsx(p,{elevation:3,sx:{height:"100%"},children:s.jsxs(u,{children:[s.jsxs(l,{sx:{display:"flex",alignItems:"center",mb:3},children:[s.jsx(C,{src:(i==null?void 0:i.photo_url)||e.profile_photo_url,sx:{width:80,height:80,mr:2,bgcolor:b.palette.primary.main},onError:r=>{console.error("❌ Ошибка загрузки аватара:",r),console.log("🔍 Попытка загрузить:",(i==null?void 0:i.photo_url)||e.profile_photo_url)},onLoad:()=>{console.log("✅ Аватар успешно загружен:",(i==null?void 0:i.photo_url)||e.profile_photo_url)},children:e.first_name.charAt(0)}),s.jsxs(l,{children:[s.jsxs(n,{variant:"h5",gutterBottom:!0,children:[e.first_name," ",e.last_name||""]}),e.username&&s.jsxs(n,{variant:"body2",color:"text.secondary",children:["@",e.username]})]})]}),s.jsx(g,{sx:{mb:2}}),s.jsxs(d,{children:[s.jsxs(t,{children:[s.jsx(c,{children:s.jsx(A,{color:"primary"})}),s.jsx(a,{primary:"Telegram ID",secondary:e.telegram_id})]}),e.language_code&&s.jsxs(t,{children:[s.jsx(c,{children:s.jsx(T,{color:"primary"})}),s.jsx(a,{primary:"Язык",secondary:(j=e.language_code)==null?void 0:j.toUpperCase()})]}),e.is_premium&&s.jsxs(t,{children:[s.jsx(c,{children:s.jsx(M,{color:"primary"})}),s.jsx(a,{primary:"Премиум",secondary:"Активен"})]}),e.bio&&s.jsxs(t,{children:[s.jsx(c,{children:s.jsx(f,{color:"primary"})}),s.jsx(a,{primary:"О себе",secondary:e.bio})]})]})]})})}),s.jsx(l,{sx:{flex:1},children:s.jsx(p,{elevation:3,sx:{height:"100%"},children:s.jsxs(u,{children:[s.jsx(n,{variant:"h6",gutterBottom:!0,children:"Статус и роли"}),s.jsxs(l,{sx:{mb:3},children:[s.jsx(y,{icon:e.is_admin?s.jsx(P,{}):s.jsx(f,{}),label:e.is_admin?"Администратор":"Пользователь",color:e.is_admin?"primary":"default",sx:{mb:1}}),s.jsx(y,{icon:s.jsx(E,{}),label:`${e.subordinates?e.subordinates.length:0} подчиненных`,variant:"outlined",sx:{ml:1}})]}),s.jsx(g,{sx:{mb:2}}),e.is_admin&&e.subordinates&&e.subordinates.length>0&&s.jsxs(l,{children:[s.jsx(n,{variant:"subtitle1",gutterBottom:!0,children:"Подчиненные:"}),s.jsx(d,{dense:!0,children:e.subordinates.map(r=>s.jsx(t,{children:s.jsx(a,{primary:`${r.first_name} ${r.last_name||""}`,secondary:r.username?`@${r.username}`:""})},r.id))})]}),e.managers&&e.managers.length>0&&s.jsxs(l,{sx:{mt:2},children:[s.jsx(n,{variant:"subtitle1",gutterBottom:!0,children:"Руководители:"}),s.jsx(d,{dense:!0,children:e.managers.map(r=>s.jsx(t,{children:s.jsx(a,{primary:`${r.first_name} ${r.last_name||""}`,secondary:r.username?`@${r.username}`:""})},r.id))})]})]})})})]})]}):s.jsx(l,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:s.jsx(n,{children:"Пользователь не найден"})})};export{R as default};
