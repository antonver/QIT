import{r as m,j as r,B as x,T as p,aP as d}from"./index-CPsAi7gg.js";import{B as u}from"./Button-C1smkmiK.js";import{C as g}from"./CircularProgress-CXFRefgw.js";import{A as y}from"./Alert-b5b2f2eR.js";import"./IconButton-BH35efnM.js";const S=()=>{const[i,n]=m.useState(!1),[c,t]=m.useState(null),f=async()=>{var a,l,o;n(!0),t(null);try{const e=await d();t({type:"success",message:`CORS тест успешен! Данные: ${JSON.stringify(e)}`})}catch(e){console.error("CORS test error:",e);let s="Неизвестная ошибка";e.isTelegramWebAppError?s="Приложение должно быть открыто из Telegram WebApp":((a=e.response)==null?void 0:a.status)===401?s="Ошибка авторизации - требуется Telegram авторизация":((l=e.response)==null?void 0:l.status)===500?s="Ошибка сервера (500)":(o=e.message)!=null&&o.includes("CORS")?s="CORS ошибка - проверьте настройки сервера":e.code==="ECONNABORTED"?s="Таймаут запроса - сервер может запускаться":s=`Ошибка: ${e.message||"Неизвестная ошибка"}`,t({type:"error",message:s})}finally{n(!1)}},h=async()=>{var a,l,o;n(!0),t(null);try{const e=await d();t({type:"success",message:`Health check успешен! Данные: ${JSON.stringify(e)}`})}catch(e){console.error("Health test error:",e);let s="Неизвестная ошибка";e.isTelegramWebAppError?s="Приложение должно быть открыто из Telegram WebApp":((a=e.response)==null?void 0:a.status)===401?s="Ошибка авторизации - требуется Telegram авторизация":((l=e.response)==null?void 0:l.status)===500?s="Ошибка сервера (500)":(o=e.message)!=null&&o.includes("CORS")?s="CORS ошибка - проверьте настройки сервера":e.code==="ECONNABORTED"?s="Таймаут запроса - сервер может запускаться":s=`Ошибка: ${e.message||"Неизвестная ошибка"}`,t({type:"error",message:s})}finally{n(!1)}};return r.jsxs(x,{sx:{p:3,maxWidth:600,mx:"auto"},children:[r.jsx(p,{variant:"h4",gutterBottom:!0,children:"CORS Тест"}),r.jsx(p,{variant:"body1",sx:{mb:3},children:"Эта страница позволяет протестировать CORS настройки и подключение к бэкенду."}),r.jsxs(x,{sx:{display:"flex",gap:2,mb:3},children:[r.jsx(u,{variant:"contained",onClick:f,disabled:i,children:i?r.jsx(g,{size:20}):"Тест CORS"}),r.jsx(u,{variant:"outlined",onClick:h,disabled:i,children:i?r.jsx(g,{size:20}):"Health Check"})]}),c&&r.jsx(y,{severity:c.type,sx:{mt:2},children:c.message}),r.jsxs(p,{variant:"body2",sx:{mt:3,color:"text.secondary"},children:[r.jsx("strong",{children:"Инструкции:"}),r.jsx("br",{}),"1. Откройте приложение из Telegram WebApp для полного тестирования",r.jsx("br",{}),"2. В браузере вы увидите ошибки авторизации (это нормально)",r.jsx("br",{}),"3. CORS ошибки должны исчезнуть после правильной настройки"]})]})};export{S as default};
